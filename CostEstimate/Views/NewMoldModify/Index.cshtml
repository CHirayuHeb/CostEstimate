@model CostEstimate.Models.Common.Class;
@{
    ViewData["Title"] = "New Mold | ThaiStanley";
    //Layout = "~/Views/Shared/_MenuBar_Mold.cshtml";
    //Layout = "~/Views/Shared/_MenuBar.cshtml";
    Layout = "~/Views/Shared/_MenuBar_Mold.cshtml";
}
@{
    string _UserId = User.Claims.FirstOrDefault(s => s.Type == "UserId")?.Value;
    string _NickName = User.Claims.FirstOrDefault(s => s.Type == "NICKNAME")?.Value;
    string _Name = User.Claims.FirstOrDefault(s => s.Type == "Name")?.Value;
    string _SurName = User.Claims.FirstOrDefault(s => s.Type == "SurName")?.Value;
    string _Division = User.Claims.FirstOrDefault(s => s.Type == "Division")?.Value;
    string _Section = User.Claims.FirstOrDefault(s => s.Type == "Section")?.Value;

}

<link href="~/css/Home/siteHome.css" rel="stylesheet" />
<script type="text/javascript">document.onreadystatechange = () => { if (document.readyState === "interactive") { PositionY("NewMoldModify"); } }</script>
<div class="home-content">
    <div id="DisplayContent" class="content-box">
        <div style="" class="content-text">
            @*<div style="" class="content-text">*@
            <br />
            <div class="row center" style="padding:5px;background-color:#fadfb6;margin-bottom:5px;border:0px solid #f5b88c;margin:5px">
                <div class="col-60 " style="text-align:left">
                    <div class="grid-item fw-800  " style="text-align:left;font-size:24px;padding-top:8px"> <span style="color:#f7be68">MOLD MODIFY </span> REQUEST SHEET DETAIL.</div>

                </div>
                <div class="col-40 center" style="text-align:right;">

                    <button class="button btnBlue" style="margin-right:20px;width:auto; @(Model._ViewceMastModifyRequest.mfStep > 1 ? "" : "display:none")"
                            onclick="Menubar_PrintMoldQUOTATION('@Url.Action("PrintMoldQUOTATION","NewMoldModify")','@Model._ViewceMastModifyRequest.mfCENo')">
                        <img src="~/images/printer.png" style="width:33px;height:24px;padding-right:5px;margin-right:8px;margin-top: 2px;margin-bottom: 2px;" />
                        REPORT
                    </button>
                    <button class="button" style="width:auto" onclick="Menubar_Moldsendmail($('#i_NewMold_DocumentNo').val(),'@Url.Action("History","NewMoldModify")')">
                        <img src="~/images/direct.png" style="width:30px;height:24px;padding-right:5px;margin-right:8px;margin-top: 2px;margin-bottom: 2px;" />
                        SEND
                    </button>

                    <button class="button btnGray" style="width:auto ; @(Model._ViewceMastModifyRequest.mfStep == 6 ? "pointer-events: none;" : "")"
                            onclick="Menubar_MoldsaveDraft('@Url.Action("SaveDraft","NewMoldModify")','@Url.Action("SaveCeDetailSub","NewMoldModify")')">
                        <img src="~/images/savedaft.png" style="width:30px;height:24px;padding-right:5px;margin-right:8px;margin-top: 2px;margin-bottom: 2px;" />
                        SAVE DAFT
                    </button>
                </div>
            </div>
            @*<form action="" id="formMoldRequest" name="formMoldData">*@
            @*<form action="" id="formMoldRequest" name="formMoldData" enctype="multipart/form-data">*@
            <div style="width:100%;">
                <div id="divSearchMain" style="margin-inline: auto;border: 0px solid white; background-color: aliceblue;padding:10px;border-radius:2px;">
                    @*form1*@
                    <form id="formMoldRequest1" name="formMoldData1">
                        <div class="row center">
                            <div class="col-5 " style="">
                            </div>
                            <div class="col-90 " style="">
                                @await Html.PartialAsync("_PartialStepFlowMoldModify.cshtml", Model)
                            </div>
                            <div class="col-5 " style="">
                            </div>

                        </div>
                        <div class="row center" style="@(Model._ViewceMastModifyRequest.mfStep == 6
                                                                            || (Model._ViewceMastModifyRequest.mfStep == 0 && (Model._ViewceMastModifyRequest.mfEmpCodeRequest != null && Model._ViewceMastModifyRequest.mfEmpCodeRequest != "") && Model._ViewceMastModifyRequest.mfEmpCodeRequest != _UserId )
                                                                            || (Model._ViewceMastModifyRequest.mfStep > 0 && (Model._ViewceMastModifyRequest.mfEmpCodeApprove != null && Model._ViewceMastModifyRequest.mfEmpCodeApprove != "") && Model._ViewceMastModifyRequest.mfEmpCodeApprove != _UserId )
                                                                            ? "pointer-events: none;" : "")">


                            <div class="row center">
                                <div class="col-5 " style="">
                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center " style="text-align:left;font-size:12px">Reference No.</div>
                                </div>
                                <div class="col-25 " style=" display: flex;align-items: center; ">
                                    <input type="text" class="form-control left " style="width:100%;height:80%;font-size:12px;background-color:yellow" autocomplete="off" asp-for="_ViewceMastModifyRequest.mfRefNo" id="i_NewMold_ReferenceNo" maxlength="20">
                                    @*<input type="text" class="form-control left text-gray" style=" @(@Model._ViewceMastSubMakerRequest.smOrderNo != null ? "pointer-events: none;width:100%;height:80%;font-size:12px" : "width:100%;height:80%;font-size:12px")" autocomplete="off" asp-for="
                                        .smOrderNo" id="i_New_OrderNo"
                                                                 readonly="@(@Model._ViewceMastModifyRequest !=null ? (@Model._ViewceMastModifyRequest.mfRefNo != null ? "readonly" : null) : null)"

                                                                >*@
                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center " style="text-align:left;font-size:12px">Document No.</div>
                                </div>
                                <div class="col-25" style=" display: flex;align-items: center; ">
                                    <input type="text" class="form-control left " style="width:100%;height:80%;font-size:12px;background-color:lightgray" autocomplete="off" asp-for="_ViewceMastModifyRequest.mfCENo" id="i_NewMold_DocumentNo" readonly>
                                </div>
                                <div class="col-5 " style="">
                                </div>
                            </div>
                            <div class="row center">
                                <div class="col-5 " style="">
                                </div>
                                <div class="col-20 border1_5brown " style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center " style="text-align:left;font-size:12px">Lot No.</div>
                                </div>

                                <div class="col-25" style=" display: flex;align-items: center; ">
                                    <input type="text" class="form-control" id="i_NewMold_LotNo" style="font-size:12px;width:100%;background-color:yellow" autocomplete="off" asp-for="_ViewceMastModifyRequest.mfLotNo" maxlength="20" />
                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center" style="text-align:left;">Revision.</div>
                                </div>
                                <div class="col-25" style=" display: flex;align-items: center; ">
                                    <input type="text" class="form-control left" style="width:50%;height:80%;font-size:12px;background-color:lightgray" autocomplete="off" id="i_NewMold_Rev" asp-for="_ViewceMastModifyRequest.mfRevision" readonly>
                                </div>
                                <div class="col-5 " style="">

                                </div>
                            </div>
                            <div class="row center">
                                <div class="col-5 " style="">

                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center" style="text-align:left;">Customer Name</div>
                                </div>
                                <div class="col-25 " style=" display: flex;align-items: center; ">
                                    <input type="text" class="form-control left" style="width:100%;height:80%;font-size:12px;background-color:lightgray" autocomplete="off" asp-for="_ViewceMastModifyRequest.mfCustomerName" id="i_NewMold_CustomerName" readonly>
                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center; ">
                                    <div class="grid-item fw-800 center" style="text-align:left;">Mold No. / Mold Name.</div>
                                </div>
                                <div class="col-25 " style=" display: flex;align-items: center; ">
                                    @Html.TextAreaFor(model => model._ViewceMastModifyRequest.mfMoldNoOrMoldName, new { @class = "form-control left", rows = 2, @readonly = "readonly", @id = "i_NewMold_MoldName", @style = "width:100%;field-sizing: content;font-size:12px;background-color:lightgray;" })
                                    @*@Html.TextAreaFor(model => model._ViewceMastSubMakerRequest.smMoldName, new { @class = "form-control left", rows = 2, @readonly = "readonly", @id = "i_New_MoldName", @style = "width:100%;field-sizing: content;font-size:12px;background-color:lightgray;" })*@
                                    @*<input type="text" class="form-control left" style="width:100%;height:80%;font-size:12px;background-color:lightgray" autocomplete="off" asp-for="_ViewceMastSubMakerRequest.smMoldName" id="i_New_MoldName" readonly>*@
                                </div>
                                <div class="col-5 " style="">

                                </div>
                            </div>
                            <div class="row center">
                                <div class="col-5 " style="">

                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center; ">
                                    <div class="grid-item fw-800 center" style="text-align:left;">Model Name</div>
                                </div>
                                <div class="col-25 " style=" display: flex;align-items: center; ">
                                    <input type="text" class="form-control left" style="width:100%;height:80%;font-size:12px;background-color:yellow" autocomplete="off" id="i_NewMold_ModelName" asp-for="_ViewceMastModifyRequest.mfModelName">
                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center; ">
                                    <div class="grid-item fw-800 center" style="text-align:left;">Cavity No.</div>
                                </div>
                                <div class="col-25 " style=" display: flex;align-items: center; ">
                                    <input type="number" min="0" class="form-control left" style="width:50%;height:80%;font-size:12px;text-align:left;background-color:yellow" autocomplete="off" asp-for="_ViewceMastModifyRequest.mfCavityNo" id="i_NewMold_CavityNo">
                                </div>
                                <div class="col-5 " style="">

                                </div>

                            </div>
                            <div class="row center">
                                <div class="col-5 " style="">

                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center" style="text-align:left;">Function</div>
                                </div>
                                <div class="col-25" style=" display: flex;align-items: center; ">
                                    <input type="text" class="form-control left" style="width:100%;height:80%;font-size:12px;background-color:lightgray" autocomplete="off" id="i_NewMold_Function" asp-for="_ViewceMastModifyRequest.mfFunction" readonly>
                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center" style="text-align:left;">Request By</div>
                                </div>
                                <div class="col-25 " style=" display: flex;align-items: center; ">
                                    @Html.DropDownListFor(m => m._ViewceMastModifyRequest.mfIssueDept, (SelectList)ViewBag.TypeofRequestBy, "กรุณาเลือก", new { @class = "form-control", id = "i_NewMold_RequestBy", autocomplete = "off", @style = "width:100%;font-size:12px;background-color:yellow;height:80%;" })

                                </div>
                                <div class="col-5 " style="">

                                </div>


                            </div>
                            <div class="row center">
                                <div class="col-5 " style="">

                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center; ">
                                    <div class="grid-item fw-800 center" style="text-align:left;">Date Issue</div>
                                </div>
                                <div class="col-25" style=" display: flex;align-items: center; ">
                                    <input type="text" id="i_NewMold_SDate" class="input-with-image form-control  text-black" style="width:100%;font-size:12px;text-align: center;background-color:lightgray" autocomplete="off" readonly asp-for="_ViewceMastModifyRequest.mfIssueDate">
                                    @*<input type="text" id="i_New_SDate" class="input-with-image form-control  text-black" style="width:100%;font-size:12px;text-align: center" autocomplete="off" readonly asp-for="_ViewceMastSubMakerRequest.smIssueDate"  value="@DateTime.Today.ToString("yyyy-MM-dd")">*@
                                </div>

                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center" style="text-align:left;">Mold Mass.</div>
                                </div>
                                <div class="col-25 " style=" display: flex;align-items: center; ">
                                    <input type="text" class="input-with-image Monthpicker  form-control center" style="width:100%;font-size:12px;background-color:yellow" autocomplete="off" id="i_NewMold_MoldMass" asp-for="_ViewceMastModifyRequest.mfMoldMass">
                                </div>
                                <div class="col-5 " style="">

                                </div>

                            </div>

                            <div class="row center">
                                <div class="col-5 " style="">

                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center" style="text-align:left;">Type of Cavity</div>
                                </div>
                                <div class="col-25" style=" display: flex;align-items: center; ">
                                    @*<input type="text" class="form-control left" style="width:100%;height:80%;font-size:12px;background-color:yellow" autocomplete="off" id="i_New_TypeCavity" asp-for="_ViewceMastSubMakerRequest.smTypeCavity">*@

                                    @Html.DropDownListFor(m => m._ViewceMastModifyRequest.mfTypeCavity, (SelectList)ViewBag.TypeofCavity, "กรุณาเลือก", new { @class = "form-control", id = "i_NewMold_TypeCavity", autocomplete = "off", @style = "width:100%;font-size:12px;background-color:yellow;height:80%;" })
                                </div>

                                <div class="col-20 border1_5brown " style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center " style="text-align:left;font-size:12px">Lead Time(DAY)</div>
                                </div>
                                <div class="col-25 " style=" display: flex;align-items: center; ">
                                    <input type="number" min="0" class="form-control left " style="width:40%;height:80%;font-size:12px;background-color:yellow" autocomplete="off" asp-for="_ViewceMastModifyRequest.mfLeadTime" id="i_NewMold_LeadTime">
                                    @*<input type="text" class="form-control left text-gray" style=" @(@Model._ViewceMastSubMakerRequest.smOrderNo != null ? "pointer-events: none;width:100%;height:80%;font-size:12px" : "width:100%;height:80%;font-size:12px")" autocomplete="off" asp-for="_ViewceMastSubMakerRequest.smOrderNo" id="i_New_OrderNo">*@
                                </div>
                                <div class="col-5 " style="">

                                </div>

                            </div>
                            <div class="row center">
                                <div class="col-5 " style="">

                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center" style="text-align:left;">ICS Name.</div>
                                </div>
                                <div class="col-25" style=" display: flex;align-items: center; ">
                                    @*<input type="text" class="form-control left" style="width:100%;height:80%;font-size:12px;background-color:yellow" autocomplete="off" id="i_New_TypeCavity" asp-for="_ViewceMastSubMakerRequest.smTypeCavity">*@
                                    @Html.TextAreaFor(model => model._ViewceMastModifyRequest.mfIcsname, new { @class = "form-control left", rows = 2, @readonly = "readonly", @id = "i_New_MoldIcsName", @style = "width:100%;field-sizing: content;font-size:12px;background-color:lightgray;" })
                                </div>

                                <div class="col-20 " style=" display: flex;align-items: center;">
                                </div>
                                <div class="col-25 " style=" display: flex;align-items: center; ">
                                </div>
                                <div class="col-5 " style="">

                                </div>

                            </div>
                            <div class="row center">
                                <div class="col-5 " style="">

                                </div>
                                <div class="col-90" style="">
                                    <hr style="border:1px solid black" />
                                </div>
                                <div class="col-5" style="">

                                </div>
                            </div>
                            <div class="row center">
                                <div class="col-5 " style="">

                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center" style="text-align:left;">Estimate Cost (Baht)</div>
                                </div>
                                <div class="col-25" style=" display: flex;align-items: center; ">

                                    <input type="number" class="form-control right" style="width:100%;font-size:12px;background-color:yellow" autocomplete="off" id="i_NewMold_EstimateCost" asp-for="_ViewceMastModifyRequest.mfESTCost" min="0">

                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center" style="text-align:left;">MK Price Cost (Baht)</div>
                                </div>
                                <div class="col-25" style=" display: flex;align-items: center; ">

                                    <input type="number" class="form-control right" style="width:100%;font-size:12px;background-color:yellow" autocomplete="off" id="i_NewMold_MKPriceCost" asp-for="_ViewceMastModifyRequest.mfMKPrice" min="0">

                                </div>
                                <div class="col-5 " style="">
                                </div>
                            </div>
                            <div class="row center">
                                <div class="col-5 " style="">

                                </div>
                                <div class="col-20 border1_5brown" style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center" style="text-align:left;">Result Cost (Baht)</div>
                                </div>
                                <div class="col-25" style=" display: flex;align-items: center; ">

                                    <input type="number" class="form-control right" style="width:100%;font-size:12px;background-color:yellow" autocomplete="off" id="i_NewMold_ResultCost" asp-for="_ViewceMastModifyRequest.mfResultCost" min="0">

                                </div>
                                <div class="col-20" style=" display: flex;align-items: center;">

                                </div>
                                <div class="col-25" style=" display: flex;align-items: center; ">

                                </div>
                                <div class="col-5 " style="">
                                </div>
                            </div>
                            <div class="row center">
                                <div class="col-5 " style="">

                                </div>
                                <div class="col-90" style="">
                                    <hr style="border:1px solid black" />
                                </div>
                                <div class="col-5" style="">

                                </div>
                            </div>
                            <div class="row center">
                                <div class="col-5 " style="">
                                </div>
                                <div class="col-20 border1_5brown " style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center " style="text-align:left;font-size:12px">Charge Rate version</div>
                                </div>
                                <div class="col-25 " style=" display: flex;align-items: center; ">
                                    <input type="text" class="form-control left " style="width:100%;height:80%;font-size:12px;background-color:lightgray" autocomplete="off" asp-for="_ViewceMastModifyRequest.mfIssueRate" id="i_NewMold_IssueRate" readonly>
                                    @*<input type="text" class="form-control left text-gray" style=" @(@Model._ViewceMastSubMakerRequest.smOrderNo != null ? "pointer-events: none;width:100%;height:80%;font-size:12px" : "width:100%;height:80%;font-size:12px")" autocomplete="off" asp-for="_ViewceMastSubMakerRequest.smOrderNo" id="i_New_OrderNo">*@
                                </div>
                                <div class="col-20 " style=" display: flex;align-items: center;">

                                </div>
                                <div class="col-25" style=" display: flex;align-items: center; ">
                                </div>
                                <div class="col-5 " style="">
                                </div>
                            </div>
                            <div class="row center">
                                <div class="col-5 " style="">
                                </div>
                                <div class="col-20 border1_5brown " style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center " style="text-align:left;font-size:12px">Cost Rate</div>
                                </div>
                                <div class="col-25 " style=" display: flex;align-items: center; ">
                                    @*<input type="text" class="input-with-image MMYYpicker  form-control center" style="width:100%;font-size:12px;background-color:yellow" id="i_NewMold_CostRate" asp-for="_ViewceMastModifyRequest.mfCostRate" onchange="FCallProcessDetail()">*@

                                    @Html.DropDownListFor(m => m._ViewceMastModifyRequest.mfCostRate, new SelectList(Model._ListMlistMonth, "Month", "Month"), "กรุณาเลือก", new { @class = "form-control", id = "i_NewMold_CostRate", autocomplete = "off", style = "width:100%;font-size:12px;background-color:yellow;height:80%;" })

                                </div>
                                <div class="col-20" style=" display: flex;align-items: center;">
                                    <input type="text" class=" form-control center" style="width:100%;font-size:12px;background-color:lightgray" autocomplete="off" id="i_NewMold_CostRateType" asp-for="_ViewceMastModifyRequest.mfCostType">

                                    @*<div class="grid-item fw-800 center " style="text-align:left;font-size:12px">Type</div>*@
                                </div>
                                <div class="col-25" style=" display: flex;align-items: center; ">
                                    @*@Html.DropDownListFor(m => m._ViewceMastSubMakerRequest.smTypeCavity, (SelectList)ViewBag.TypeofMODIFICATION, "กรุณาเลือก", new { @class = "form-control", id = "i_NewMold_TypeCavity", autocomplete = "off", @style = "width:100%;font-size:12px;background-color:yellow;height:80%;" })*@
                                </div>
                                <div class="col-5 " style="">
                                </div>
                            </div>
                            <div class="row center">
                                <div class="col-5 " style="">
                                </div>
                                <div class="col-20 border1_5brown " style=" display: flex;align-items: center;">
                                    <div class="grid-item fw-800 center " style="text-align:left;font-size:12px">Type</div>
                                </div>
                                <div class="col-25 " style=" display: flex;align-items: center; ">
                                    @Html.DropDownListFor(m => m._ViewceMastModifyRequest.mfType, (SelectList)ViewBag.TypeofMODIFICATION, "กรุณาเลือก", new { @class = "form-control", id = "i_NewMold_Type", autocomplete = "off", @style = "width:100%;font-size:12px;background-color:yellow;height:80%;" })


                                </div>
                                <div class="col-20 " style=" display: flex;align-items: center;">
                                    <input type="text" class=" form-control center" style="width:100%;font-size:12px;background-color:lightgray;display:none" autocomplete="off" id="i_NewMold_mfProcess" asp-for="_ViewceMastModifyRequest.mfProcess">
                                </div>
                                <div class="col-25" style=" display: flex;align-items: center; ">

                                </div>
                                <div class="col-5 " style="">
                                </div>
                            </div>

                        </div>
                        @*<div id="ResultMoldProcess" class="row center">
                                @await Html.PartialAsync("_PartialNewMoldRequestProcess", Model)
                            </div>*@
                    </form>
                    <br />
                    @*<div class="row">
                            <div class="col-70">
                                <form id="formMoldRequest2" name="formMoldData2">
                                    <div id="ResultMoldProcess" class="row center" style="@(Model._ViewceMastModifyRequest.mfStep == 6
                                                                                || (Model._ViewceMastModifyRequest.mfStep == 0 && (Model._ViewceMastModifyRequest.mfEmpCodeRequest != null && Model._ViewceMastModifyRequest.mfEmpCodeRequest != "") && Model._ViewceMastModifyRequest.mfEmpCodeRequest != _UserId )
                                                                                || (Model._ViewceMastModifyRequest.mfStep > 0 && (Model._ViewceMastModifyRequest.mfEmpCodeApprove != null && Model._ViewceMastModifyRequest.mfEmpCodeApprove != "") && Model._ViewceMastModifyRequest.mfEmpCodeApprove != _UserId )
                                                                                ? "pointer-events: none;" : "")">
                                        @await Html.PartialAsync("_PartialNewMoldRequestProcess", Model)
                                    </div>
                                </form>
                            </div>
                            <div class="col-30">
                                @await Html.PartialAsync("_PartialNewMoldRequestMaterial", Model)
                            </div>
                        </div>*@

                    @*@await Html.PartialAsync("_PartialNewMoldDetail_Mat", Model)*@

                    <form id="formMoldRequest2" name="formMoldData2">
                        <div id="ResultMoldProcess" class="row center" style="@(Model._ViewceMastModifyRequest.mfStep == 6
                                                                            || (Model._ViewceMastModifyRequest.mfStep == 0 && (Model._ViewceMastModifyRequest.mfEmpCodeRequest != null && Model._ViewceMastModifyRequest.mfEmpCodeRequest != "") && Model._ViewceMastModifyRequest.mfEmpCodeRequest != _UserId )
                                                                            || (Model._ViewceMastModifyRequest.mfStep > 0 && (Model._ViewceMastModifyRequest.mfEmpCodeApprove != null && Model._ViewceMastModifyRequest.mfEmpCodeApprove != "") && Model._ViewceMastModifyRequest.mfEmpCodeApprove != _UserId )
                                                                            ? "pointer-events: none;" : "")">
                            @await Html.PartialAsync("_PartialNewMoldRequestProcess", Model)
                        </div>
                    </form>
                    @*<div id="ResultMoldProcess" class="row center">
                            @await Html.PartialAsync("_PartialNewMoldRequestProcess", Model)
                        </div>*@

                    @*form2*@
                    <form action="" id="formMoldRequest3" name="formMoldData3">
                        @*<div id="ResultMoldMaterial" class="row center" style="@(Model._ViewceMastModifyRequest.mfStep == 6
                            || (Model._ViewceMastModifyRequest.mfStep == 0 && (Model._ViewceMastModifyRequest.mfEmpCodeRequest != null && Model._ViewceMastModifyRequest.mfEmpCodeRequest != "") && Model._ViewceMastModifyRequest.mfEmpCodeRequest != _UserId )
                            || (Model._ViewceMastModifyRequest.mfStep > 0 && (Model._ViewceMastModifyRequest.mfEmpCodeApprove != null && Model._ViewceMastModifyRequest.mfEmpCodeApprove != "") && Model._ViewceMastModifyRequest.mfEmpCodeApprove != _UserId )
                            ? "pointer-events: none;" : "")">*@
                        <div id="ResultMoldMaterial" class="row center">
                            @await Html.PartialAsync("_PartialNewMoldRequestMaterial", Model)
                        </div>

                        @*form3*@

                        <div class="row center" style="@(Model._ViewceMastModifyRequest.mfStep == 6
                                                                            || (Model._ViewceMastModifyRequest.mfStep == 0 && (Model._ViewceMastModifyRequest.mfEmpCodeRequest != null && Model._ViewceMastModifyRequest.mfEmpCodeRequest != "") && Model._ViewceMastModifyRequest.mfEmpCodeRequest != _UserId )
                                                                            || (Model._ViewceMastModifyRequest.mfStep > 0 && (Model._ViewceMastModifyRequest.mfEmpCodeApprove != null && Model._ViewceMastModifyRequest.mfEmpCodeApprove != "") && Model._ViewceMastModifyRequest.mfEmpCodeApprove != _UserId )
                                                                            ? "pointer-events: none;" : "")">
                            @await Html.PartialAsync("_PartialNewMoldSummary", Model)
                        </div>
                        <div class="row center" style="@(Model._ViewceMastModifyRequest.mfStep == 6
                                                                            || (Model._ViewceMastModifyRequest.mfStep == 0 && (Model._ViewceMastModifyRequest.mfEmpCodeRequest != null && Model._ViewceMastModifyRequest.mfEmpCodeRequest != "") && Model._ViewceMastModifyRequest.mfEmpCodeRequest != _UserId )
                                                                            || (Model._ViewceMastModifyRequest.mfStep > 0 && (Model._ViewceMastModifyRequest.mfEmpCodeApprove != null && Model._ViewceMastModifyRequest.mfEmpCodeApprove != "") && Model._ViewceMastModifyRequest.mfEmpCodeApprove != _UserId )
                                                                            ? "pointer-events: none;" : "")">
                            @await Html.PartialAsync("_PartialNewMoldRequestDetail", Model)
                        </div>
                        <div class="row center">
                            @await Html.PartialAsync("_PartialNewMoldAttachFile", Model)
                        </div>

                        @*<div id="ResultMoldProcess" class="row center">
                                @await Html.PartialAsync("_PartialNewMoldRequestProcess", Model)
                            </div>*@

                        <!-- Modal send mail -->
                        <div class="modal modal-lg fade" id="myModalSendMold" style="background-color:#4f4b4b4d;" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content ">
                                    <div class="modal-body" id="myModalBodySendMold">

                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>




                </div>
            </div>




        </div>
    </div>
    <!-- Modal QUOTATION  -->
    <div class="modal modal-sxl fade" id="myModalMoldQUOTATION" style="background-color:#4f4b4b4d;" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog" style="min-width: 900px; width: 900px;">
            <div class="modal-content">
                <div class="modal-body" id="myModalBodyDivMoldQUOTATION">
                    <div class="modal-header" style="margin-top:1px">
                        <h5 class="modal-title">
                            <span style="font-weight: bold; font-size: 16px;"><img src="~/images/quotation.png" height="35px" width="35px" style="vertical-align:middle;margin-right:10px" /> Quotation Mold Modify </span>
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <br />
                        <div id="loadingIndicatorMoldQuotation" style="display: block; position: absolute; left: 50%; transform: translate(-50%, -50%); z-index: 9999;margin:0px">
                            @*<div class="loader"></div>*@
                            <img src="~/images/wait1.gif" alt="Loading..." width="100px"><span style="font-weight:600">Loading...</span>
                        </div>

                        <div id="ResultMoldQuotation" style="display: none;">
                            @await Html.PartialAsync("_PartialDisplayMoldQuotation", Model);
                        </div>
                    </div>
                    <div class="modal-footer" style="width: 100%;">
                        <button class="btn btn-primary" onclick="printQuotationA4('@Model._ViewceMastModifyRequest.mfCENo','NewMoldModify?id=','MoldModify')" style="@(Model._ViewceMastModifyRequest.mfStep >5 ? "" : "display:none")">🖨 พิมพ์ A4</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal openfile user-->
    <div class="modal modal fade" id="myModalNewMold" style="background-color:#4f4b4b4d;" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body" id="myModalBodyNewMold">
                    <div class="modal-header" style="margin-top:1px">
                        <h5 class="modal-title">
                            <span style="font-weight: bold; font-size: 16px;"><img src="~/images/folders.png" height="35px" width="35px" style="vertical-align:middle" />  เอกสาร​ทั้งหมดของผู้ร้องขอ  @Model._listAttachment.Count() ไฟล์</span>
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class=" panel-group ir fadeInUp animated wowload animated" style="visibility: visible; animation-name: fadeInUp; margin-bottom: 5px; ">
                        <div class="panel panel-default property">
                            <div class=" panel-heading panel-heading-custom property" tabindex="0">
                                <br>
                                <h4 class="panel-title faq-title-range" data-bs-toggle="collapse" data-bs-target="#History" aria-expanded="true" aria-controls="collapseExample">
                                    <label style="font-size:15px;font-weight:800">
                                        ไฟล์แนบ
                                    </label>
                                    <label class="lbV">
                                    </label>
                                </h4>
                            </div>
                            <div class="panel-collapse collapse show" id="History" style="overflow-y: scroll; max-height: 200px;">
                                @*<div id="divHistory" class="panel-body">
                                    </div>*@
                                <div class="panel-body">
                                    <table class="summarys">
                                        <tr>
                                            <th>No</th>
                                            <th>Name File</th>
                                            <th style="width:50px">Delete</th>
                                        </tr>


                                        @if (@Model._listAttachment != null)
                                        {

                                            var row = 0;
                                            @foreach (var item in @Model._listAttachment)
                                            {
                                                <tr>
                                                    <td> <label>@(row += 1)</label></td>
                                                    <td>

                                                        <a href="@Url.Action("openFile", "New", new { pathFile = @item.fnFilename })" class="btn-image" target="_blank" style="padding-left:5px;text-decoration:auto;">
                                                            @item.fnFilename
                                                        </a>
                                                    </td>
                                                    <td style="text-align:center">

                                                        @*<input type="button" style="font-size:14px" value="&#x274C" disabled>*@
                                                        @if (@_UserId == @Model._ViewceMastModifyRequest.mfEmpCodeApprove && @Model._ViewceMastModifyRequest.mfStep < 6)
                                                        {
                                                            <input type="button" style="font-size:14px" value="&#x274C" onclick="DeleteFileUser('@item.fnNo','@item.fnFilename','@Url.Action("DeteleDataFile","NewMoldModify")')">
                                                        }
                                                        else
                                                        {
                                                            <input type="button" style="font-size:14px" value="&#x274C" disabled>
                                                        }
                                                        @*<input type="button" style="@(@_UserId == @Model._ViewsvsServiceRequest.srRequestBy|| @_UserId == @Model._ViewsvsServiceRequest.srApproveEmpcode ? "font-size:14px" : "pointer-events: none; font-size:14px")" value="&#x274C" onclick="DeleteFileUser('@item.fnNo','@item.fnFilename','@Url.Action("DeteleDataFile","RequestForm")')">*@

                                                        @*<input type="button" style="font-size:14px" value="&#x274C" onclick="DeleteFileUser('@item.fnNo','@item.fnFilename','@Url.Action("DeteleDataFile","RequestForm")')">*@
                                                    </td>
                                                </tr>


                                                @*<input type="button" value="&#x274C">*@

                                            }

                                        }
                                    </table>
                                </div>


                            </div>


                        </div>
                    </div>
                    @*<div class="modal-footer" style="width: 100%;">

                            <button type="button" class="button btnRed" data-bs-dismiss="modal" style="width:80px;height:30px">Close</button>

                        </div>*@
                </div>
            </div>
        </div>
    </div>


</div>
<script type="text/javascript">
        $(function () {
            function split(val) {
                return val.split(/,\s*/);
            }
            function extractLast(term) {
                return split(term).pop();
            }

            $("#i_NewMold_LotNo")
           //don't navigate away from the field on tab when selecting an item
                 .on("keydown", function (event) {
                     console.log("OK");
              if (event.keyCode === $.ui.keyCode.TAB &&
                  $(this).autocomplete("instance").menu.active) {
                  console.log("OK1");
                  event.preventDefault();
              }
          })
            .autocomplete({
                minLength: 1,
                source: function (request, response) {
                    $.getJSON('@Url.Action("SearchMold_Ledger_Number", "NewMoldModify")', {
                        term: extractLast(request.term)
                    }, response);
                },
                focus: function () {
                     //prevent value inserted on focus
                    return false;
                },
                select: function (event, ui) {
                    const LotNo = ui.item.value.split("|")[0];
                    console.log("test LotNo" + LotNo);
                    //console.log("test i_NewMold_EstimateCost" + ui.item.value.split("|")[4]);
                    //console.log("test i_NewMold_MKPriceCost" + ui.item.value.split("|")[5]);
                    //console.log("test i_NewMold_ResultCost" + ui.item.value.split("|")[6]);


                    document.getElementById("i_NewMold_CustomerName").value = ui.item.value.split("|")[1];
                    document.getElementById("i_NewMold_MoldName").value = ui.item.value.split("|")[2];
                    document.getElementById("i_NewMold_CavityNo").value = ui.item.value.split("|")[3];
                    document.getElementById("i_NewMold_EstimateCost").value = ui.item.value.split("|")[4];

                    document.getElementById("i_NewMold_ResultCost").value = ui.item.value.split("|")[5];
                    document.getElementById("i_NewMold_MKPriceCost").value = ui.item.value.split("|")[6];

                    document.getElementById("i_New_MoldIcsName").value = ui.item.value.split("|")[7];
                    document.getElementById("i_NewMold_Function").value = ui.item.value.split("|")[8];





                    //let email365 = myArray[0];
                    //console.log("test" + LotNo);

                    var terms = split(this.value);
                     //remove the current input
                    terms.pop();
                     //add the selected item

                    //terms.push(ui.item.value);
                    terms.push(LotNo);
                     //add placeholder to get the comma-and-space at the end
                    terms.push("");
                    this.value = terms.join("");
                    return false;
                }
                });


            $("#i_NewMold_ModelName")
           //don't navigate away from the field on tab when selecting an item
                 .on("keydown", function (event) {
                     console.log("OK2");
              if (event.keyCode === $.ui.keyCode.TAB &&
                  $(this).autocomplete("instance").menu.active) {
                  console.log("OK2");
                  event.preventDefault();
              }
          })
            .autocomplete({
                minLength: 1,
                source: function (request, response) {
                    $.getJSON('@Url.Action("SearchModelName", "NewMoldModify")', {
                        term: extractLast(request.term)
                    }, response);
                },
                focus: function () {
                     //prevent value inserted on focus
                    return false;
                },
                select: function (event, ui) {
                    const email365 = ui.item.value;
                    //let email365 = myArray[0];
                    console.log("test" + email365);

                    var terms = split(this.value);
                     //remove the current input
                    terms.pop();
                     //add the selected item

                    //terms.push(ui.item.value);
                    terms.push(email365);
                     //add placeholder to get the comma-and-space at the end
                    terms.push("");
                    this.value = terms.join("");

                    @*let mydata = $("#formRequest").serialize();
                    //'@Url.Action("SearchbyModelName", "NewMoldModify")',
                    $.ajax({
                        url:'@Url.Action("SearchbyModelName", "NewMoldModify")',//'/New/SearchbyModelName', // URL ของ Controller
                        type: 'POST',
                        data: {
                            search: email365,
                            class: mydata

                        },
                        beforeSend: function () {
                            // Show Loading ก่อนส่งข้อมูล
                            $("#loading").show();
                        },
                        success: function (response) {
                            //console.log("wwwwwwwww");
                          $("#ResultMoldProcess").html(response); // เอา HTML Partial View มาใส่ใน Div

                        },
                        complete: function () {
                            // ซ่อน Loading เมื่อทำงานเสร็จ
                            $("#loading").hide();

                        },
                        error: function () {
                            alert("Error!!");
                        }
                    });*@


                    return false;
                }
                });
    })

    $(document).ready(function () {
        $('#i_NewMold_CostRate').on('change', function () {
            FCallProcessDetail();
        });
    });


    function FCallProcessDetail() {
        let mydata = $("#formMoldRequest2").serialize();
        let vCostIssueRate = document.getElementById("i_NewMold_IssueRate").value;
        let vCostRate = document.getElementById("i_NewMold_CostRate").value;
          $.ajax({
              url:'@Url.Action("SearchbyModelName", "NewMoldModify")',//'/New/SearchbyModelName', // URL ของ Controller
              type: 'POST',
              data: {
                  search: vCostRate,
                  issueRate: vCostIssueRate,
                  class: mydata

              },
              beforeSend: function () {
                  // Show Loading ก่อนส่งข้อมูล
                  document.getElementById("i_NewMold_ReferenceNo").focus();
                  $("#loading").show();
              },
              success: function (response) {
                  $("#ResultMoldProcess").html(response); // เอา HTML Partial View มาใส่ใน Div
                  //var vmfCostType = $("#ResultMoldProcess").find("#divmfCostType").data("test");
                  //console.log("vmfCostType" + vmfCostType); // จะได้ "test"

                  var vmfCostType = $("#ResultMoldProcess").find("#divmfCostType").data("test");
                  document.getElementById("i_NewMold_CostRateType").value = vmfCostType;
                  console.log(" vmfCostType" + vmfCostType); // จะได้ "test"

                  document.getElementById("i_NewMold_Type").focus();

              },
              complete: function () {
                  // ซ่อน Loading เมื่อทำงานเสร็จ
                  $("#loading").hide();

              }
           });
    }




</script>
